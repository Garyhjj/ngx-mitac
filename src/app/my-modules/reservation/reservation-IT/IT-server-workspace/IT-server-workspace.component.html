<nz-tabset>
  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.nearlyOverTime' | translate}}
      <nz-badge [nzCount]="nearlyOutTimeCount" *ngIf="nearlyOutTimeCount">
        <ng-template #content>
          &nbsp;&nbsp;
        </ng-template>
      </nz-badge>
    </ng-template>
    <app-data-drive [name]="'reservationITWorkspace'" (dataDriveInit)="getDataDrive0($event)">
      <ng-template #actionRef let-data="data">
        <span>
          <ng-container *ngIf="data?.STATUS==='Processing'">
            <a (click)="doneResvation(data)">{{'serviceModule.finish' | translate}}</a>
            <span nz-table-divider></span>
            <a (click)="resetResvation(data)">{{'serviceModule.reset' | translate}}</a>
          </ng-container>
          <ng-container *ngIf="data?.STATUS==='New'">
            <a (click)="closeResvation(data)">{{'serviceModule.close' | translate}}</a>
            <span nz-table-divider></span>
            <a (click)="receiveResvation(data)">{{'serviceModule.accept' | translate}}</a>
          </ng-container>
        </span>
      </ng-template>
    </app-data-drive>
  </nz-tab>
  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.waitingToAccept' | translate}}
      <nz-badge [nzCount]="newCount" *ngIf="newCount">
        <ng-template #content>
          &nbsp;&nbsp;
        </ng-template>
      </nz-badge>
    </ng-template>
    <app-data-drive [name]="'reservationITWorkspace'" (dataDriveInit)="getDataDrive1($event)">
      <ng-template #actionRef let-data="data">
        <span>
          <a (click)="closeResvation(data)">{{'serviceModule.close' | translate}}</a>
          <span nz-table-divider></span>
          <a (click)="receiveResvation(data)">{{'serviceModule.accept' | translate}}</a>
        </span>
      </ng-template>
    </app-data-drive>
  </nz-tab>
  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.handling' | translate}}
      <nz-badge [nzCount]="processingCount" *ngIf="processingCount">
        <ng-template #content>
          &nbsp;&nbsp;
        </ng-template>
      </nz-badge>
    </ng-template>
    <app-data-drive [name]="'reservationITWorkspace'" (dataDriveInit)="getDataDrive2($event)">
      <ng-template #actionRef let-data="data">
        <span>
          <a (click)="doneResvation(data)">{{'serviceModule.finish' | translate}}</a>
          <span nz-table-divider></span>
          <a (click)="resetResvation(data)">{{'serviceModule.reset' | translate}}</a>
        </span>
      </ng-template>
    </app-data-drive>
  </nz-tab>
  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.overtime' | translate}}
      <nz-badge [nzCount]="outTimeCount" *ngIf="outTimeCount">
        <ng-template #content>
          &nbsp;&nbsp;
        </ng-template>
      </nz-badge>
    </ng-template>
    <app-data-drive [name]="'reservationITWorkspace'" (dataDriveInit)="getDataDrive3($event)">
      <ng-template #actionRef let-data="data">
        <span>
          <ng-container *ngIf="data?.STATUS==='Processing'">
            <a (click)="doneResvation(data)">{{'serviceModule.finish' | translate}}</a>
            <span nz-table-divider></span>
            <a (click)="resetResvation(data)">{{'serviceModule.reset' | translate}}</a>
          </ng-container>
          <ng-container *ngIf="data?.STATUS==='New'">
            <a (click)="closeResvation(data)">{{'serviceModule.close' | translate}}</a>
            <span nz-table-divider></span>
            <a (click)="receiveResvation(data)">{{'serviceModule.accept' | translate}}</a>
          </ng-container>
        </span>
      </ng-template>
    </app-data-drive>
  </nz-tab>

  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.waitingScore' | translate}}
      <nz-badge [nzCount]="commentCount" *ngIf="commentCount">
        <ng-template #content>
          &nbsp;&nbsp;
        </ng-template>
      </nz-badge>
    </ng-template>
    <app-data-drive [name]="'reservationITSelf'" (dataDriveInit)="getDataDrive4($event)">
    </app-data-drive>
  </nz-tab>

  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.ClosedService' | translate}}
    </ng-template>
    <app-data-drive [name]="'reservationITSelf'" (dataDriveInit)="getDataDrive5($event)">
      <ng-template #tableCell let-data="data" let-property="property">
        <button nz-button [nzType]="'primary'" *ngIf="property === impressionName" (click)="showImpressionDetail(data)">
          <span>{{'serviceModule.showDetail' | translate}}</span>
        </button>
      </ng-template>
    </app-data-drive>
  </nz-tab>

  <nz-tab>
    <ng-template #nzTabHeading>
      {{'serviceModule.otherPeopleOvertime' | translate}}
      <nz-badge [nzCount]="otherOutTimeCount" *ngIf="otherOutTimeCount">
        <ng-template #content>
          &nbsp;&nbsp;
        </ng-template>
      </nz-badge>
    </ng-template>
    <app-data-drive [name]="'reservationITSelf'" (dataDriveInit)="getDataDrive6($event)">
      <ng-template #actionRef let-data="data">
        <span>
          <a (click)="resetResvation(data)">{{'serviceModule.reset' | translate}}</a>
        </span>
      </ng-template>
    </app-data-drive>
  </nz-tab>
</nz-tabset>



<nz-modal [nzVisible]="isClosedVisible" [nzTitle]="'serviceModule.closeReason' | translate" [nzContent]="modalContent1" [nzFooter]="modalFooter1"
  (nzOnCancel)="isClosedVisible = false" nzWidth="560px">
  <ng-template #modalContent1>
    <form nz-form [nzLayout]="'horizontal'">

      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="6">
          <label>{{'serviceModule.closeReason' | translate}}</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="16" [style.textAlign]="'center'">
          <nz-input [(ngModel)]="reason" name="reason"></nz-input>
        </div>
      </div>
      <div nz-form-item nz-row [style.display]="'block'">
        <button nz-button nz-col [nzOffset]="6" [nzSpan]="12" type="button" [nzType]="'primary'" [nzSize]="'large'" (click)="submitClosedForm()"
          [disabled]="!reason">{{'serviceModule.confirm' | translate}}</button>
      </div>
    </form>
  </ng-template>
  <ng-template #modalFooter1>

  </ng-template>
</nz-modal>

<nz-modal [nzVisible]="isDoneVisible" [nzTitle]="'serviceModule.handle' | translate" [nzContent]="modalContent" [nzFooter]="modalFooter"
  (nzOnCancel)="isDoneVisible = false" nzWidth="560px">
  <ng-template #modalContent>
    <form nz-form [nzLayout]="'horizontal'" [formGroup]="doneForm" *ngIf="doneForm">

      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="6">
          <label>*{{'serviceModule.problemType' | translate}}</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="16">
          <app-mx-select [lazyAPI]="'IPQA/GetMRILookup?lookup_type=IT_SERVICE_TYPE'" [lazyParams]="['LOOKUP_CODE', 'LOOKUP_CODE']"
            formControlName="TYPE"></app-mx-select>
        </div>
      </div>

      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="6">
          <label>*{{'serviceModule.handleTime' | translate}}(h)</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="16">
          <nz-input-number [nzSize]="'large'" [style.width]="'50%'" formControlName="HANDLE_TIME" nzAllowClear="true"></nz-input-number>
        </div>
      </div>

      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="6">
          <label>{{'serviceModule.handleDesc' | translate}}</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="16">
          <nz-input nzType="textarea" [nzAutosize]="'1'" formControlName="REMARK"></nz-input>
        </div>
      </div>

      <div nz-form-item nz-row [style.display]="'block'">
        <button nz-button nz-col [nzOffset]="6" [nzSpan]="12" type="button" [nzType]="'primary'" [nzSize]="'large'" (click)="submitDoneForm()"
          [disabled]="doneForm.invalid">{{'serviceModule.confirm' | translate}}</button>
      </div>
    </form>
  </ng-template>
  <ng-template #modalFooter>

  </ng-template>
</nz-modal>
